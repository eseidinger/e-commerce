<?xml version="1.0" encoding="UTF-8"?>

<web-app xmlns="http://xmlns.jcp.org/xml/ns/javaee"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd"
  version="3.1">
  <distributable />
  <session-config>
    <session-timeout>
      30
    </session-timeout>
  </session-config>
  <data-source>
    <name>java:global/ecommerceDS</name>
    <class-name>org.postgresql.ds.PGSimpleDataSource</class-name>
    <server-name>${ENV=DB_HOST:localhost}</server-name>
    <port-number>5432</port-number>
    <database-name>ecommerce</database-name>
    <user>${ENV=JDBC_USER:postgres}</user>
    <!-- Example of using a Payara password alias in the datasource definition -->
    <password>${ENV=JDBC_PASSWORD:password}</password>
    <!-- Example of how to use a Payara specific custom connection pool setting -->
    <property>
      <name>fish.payara.steady-pool-size</name>
      <value>8</value>
    </property>
    <property>
      <name>fish.payara.max-pool-size</name>
      <value>32</value>
    </property>
    <property>
      <name>fish.payara.slow-query-threshold-in-seconds</name>
      <value>5</value>
    </property>
    <property>
      <name>fish.payara.log-jdbc-calls</name>
      <value>false</value>
    </property>
    <property>
      <name>fish.payara.sql-trace-listeners</name>
      <value>com.ecommerce.jsf.listener.DummySqlTraceListener</value>
    </property>
    <!-- <property>
      <name>fish.payara.is-connection-validation-required</name>
      <value>true</value>
    </property>
    <property>
      <name>fish.payara.connection-validation-method</name>
      <value>custom-validation</value>
    </property>
    <property>
      <name>fish.payara.validation-classname</name>
      <value>org.glassfish.api.jdbc.validation.MySQLConnectionValidation</value>
    </property> -->
  </data-source>

  <security-role>
    <role-name>admin</role-name>
  </security-role>
  <security-role>
    <role-name>guest</role-name>
  </security-role>

    <security-constraint>
    <web-resource-collection>
      <web-resource-name>Protected Pages</web-resource-name>
      <url-pattern>/customer.xhtml</url-pattern>
      <http-method>GET</http-method>
      <http-method>POST</http-method>
    </web-resource-collection>
    <auth-constraint>
      <role-name>admin</role-name>
    </auth-constraint>
  </security-constraint>
</web-app>
